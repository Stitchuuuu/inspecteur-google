- group: main
  name: build
  desc: Compile main code (nodejs)
  cmd: NODE_ENV=production node ../../node_modules/webpack/bin/webpack.js
  cwd: ./src/main

- group: main
  name: dev
  desc: Watch for changes & recompile code for main
  cmd: node ../../node_modules/webpack/bin/webpack.js --watch
  cwd: ./src/main

- group: renderer
  name: dev
  desc: Watch for changes & recompile renderer code (web + vuejs)
  cmd: npm run serve
  cwd: ./src/renderer

- group: renderer
  name: build
  desc: Compile renderer code (web + vuejs)
  cmd: npm run build
  cwd: ./src/renderer

- name: build
  desc: Compile the renderer & the main
  cmd: |
    wtf main build
    wtf renderer build

- name: make
  desc: Compile + create the installer
  cmd: |
    wtf build
    wtf icon
    {{ if .all }}npm run make:macos && npm run make:windows && npm run make:macos-m1{{ else }}npm run make{{ end }}
  flags:
    - name: [all]
      desc: Compile for all platforms
      test: $bool
      default: false

- group: make
  name: all
  desc: Compile + create the installer for all main platforms (macOS, macOS Apple Silicon, Windows)
  cmd: |
    wtf build
    wtf icon
    npm run make:macos
    npm run make:window
    npm run make:macos-m1

- name: icon
  cmd: |
    convert src/assets/ico/32.png src/assets/ico/64.png src/assets/ico/128.png src/assets/ico/256.png src/assets/ico/512.png src/assets/ico/1024.png assets/icon.ico
    iconutil -c icns src/assets/rounded-icon.iconset --output assets/icon.icns
    cp src/assets/ico/1024.png assets/icon.png
    cp src/assets/rounded-icon.iconset/icon_512x512@2x.png assets/rounded-icon.png

- name: start
  cmd: npm run start{{ if .production }}:production{{ end }}
  flags:
    - name: [production, p]
      desc: Start the app in production mode
      test: $bool
      default: false
  